name: Update Kaggle Stats

on:
  schedule:
    - cron: '0 */12 * * *' # Every 12 hours
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Install deps
        run: |
          sudo apt-get update
          sudo apt-get install -y curl jq imagemagick

      - name: Fetch Kaggle Stats (HTML scrape)
        run: |
          curl -s https://www.kaggle.com/aromaldileep > profile.html

      - name: Generate Stats Card
        run: |
          convert -size 800x300 xc:"#0d1117" \
            -gravity NorthWest \
            -pointsize 28 -fill "#00FF87" -annotate +20+30 "Kaggle Profile: aromaldileep" \
            -pointsize 18 -fill "#E0FFE0" -annotate +20+80 "Auto-updated Kaggle Stats" \
            assets/kaggle/kaggle.png

      - name: Commit & Push
        run: |
          git config user.name "github-actions"
          git config user.email "actions@github.com"
          git add assets/kaggle/kaggle.png
          git commit -m "Updated Kaggle Stats" || echo "No changes"
          git push
